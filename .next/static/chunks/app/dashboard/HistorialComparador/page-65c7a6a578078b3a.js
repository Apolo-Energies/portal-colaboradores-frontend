(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[187],{1138:(e,r,t)=>{"use strict";t.d(r,{N:()=>a});var s=t(5155);t(2115);let a=e=>{let{label:r,placeholder:t,value:a,onChange:l,error:n,type:o="text",icon:i}=e;return(0,s.jsxs)("div",{className:"space-y-1",children:[r&&(0,s.jsx)("label",{className:"block text-sm font-semibold text-foreground",children:r}),(0,s.jsxs)("div",{className:"relative",children:[i&&(0,s.jsx)(i,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-foreground"}),(0,s.jsx)("input",{type:o,placeholder:t,value:a,onChange:e=>l(e.target.value),className:"w-full placeholder:text-foreground bg-input text-sm rounded border px-3 py-1.5 focus:outline-none focus:ring ".concat(n?"border-red-500 ring-red-500":"border-border ring-blue-500"," ").concat(i?"pl-10":"")})]}),n&&(0,s.jsx)("p",{className:"text-xs text-red-600 mt-1",children:n})]})}},2028:(e,r,t)=>{Promise.resolve().then(t.bind(t,8151))},2039:(e,r,t)=>{"use strict";t.d(r,{b:()=>a});var s=t(5155);function a(e){let{data:r,columns:t,rowKey:a}=e;return(0,s.jsx)("div",{className:"bg-card rounded-xl shadow-sm border border-border overflow-hidden",children:(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full table-auto",children:[(0,s.jsx)("thead",{className:"bg-card border-b border-border",children:(0,s.jsx)("tr",{children:null==t?void 0:t.map(e=>(0,s.jsx)("th",{className:"px-6 py-4 text-xs font-medium text-muted-foreground uppercase tracking-wider text-".concat(e.align||"left"),children:e.label},e.key))})}),(0,s.jsx)("tbody",{className:"bg-body divide-y divide-gray-200",children:null==r?void 0:r.map(e=>(0,s.jsx)("tr",{className:"hover:bg-body transition-colors",children:null==t?void 0:t.map(r=>{var t;return(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-".concat(r.align||"left"),children:(null==r?void 0:r.render)?r.render(e):String(null!=(t=e[r.key])?t:"")},r.key)})},String(e[a])))})]})})})}t(2115)},3281:(e,r,t)=>{"use strict";t.d(r,{a:()=>a});var s=t(3464);t(9509).env.NODE_TLS_REJECT_UNAUTHORIZED="0";let a=s.A.create({baseURL:"https://api.apoloenergies.es/api/apolo/v1",responseType:"json",withCredentials:!0})},4416:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(9946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7924:(e,r,t)=>{"use strict";t.d(r,{A:()=>s});let s=(0,t(9946).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},7925:(e,r,t)=>{"use strict";t.d(r,{r:()=>s});let s=(0,t(5453).v)(e=>({loading:!1,setLoading:r=>e({loading:r})}))},8151:(e,r,t)=>{"use strict";t.d(r,{HistorialComponent:()=>g});var s=t(5155),a=t(2115),l=t(1138),n=t(7924),o=t(4416);let i=e=>{var r,t,a;let{filters:i,setFilters:d,onSearch:c}=e;return(0,s.jsxs)("div",{className:"bg-card rounded-xl shadow-sm border border-border p-6 mb-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,s.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Historial Comparador"})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(l.N,{type:"text",placeholder:"Buscar por email...",value:null!=(r=i.email)?r:"",onChange:e=>d({...i,email:e}),icon:n.A}),(0,s.jsx)(l.N,{type:"date",placeholder:"Filtrar por fecha...",value:null!=(t=i.fecha)?t:"",onChange:e=>d({...i,fecha:e})}),(0,s.jsx)(l.N,{type:"text",placeholder:"Buscar por CUPS...",value:null!=(a=i.cups)?a:"",onChange:e=>d({...i,cups:e}),icon:n.A}),(0,s.jsxs)("div",{className:"flex items-center justify-around",children:[(0,s.jsxs)("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded flex items-center justify-center gap-1 cursor-pointer",onClick:c,children:[(0,s.jsx)(n.A,{size:14}),"Buscar"]}),(0,s.jsxs)("button",{className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-3 py-1 rounded flex items-center justify-center gap-1 cursor-pointer",onClick:()=>{d({}),c()},children:[(0,s.jsx)(o.A,{size:14}),"Limpiar"]})]})]})]})};var d=t(5493),c=t(2039),u=t(7925),p=t(3464),h=t(3281);let m=async function(e){var r,t,s,a,l,n,o,i,d,c;let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let{email:s,fecha:a,cups:l,page:n=1,pageSize:o=15}=u,i=await h.a.get("/historialComparador",{headers:{Authorization:"Bearer ".concat(e)},params:{email:s,fecha:a,cups:l,page:n,pageSize:o},withCredentials:!1});return{result:i.data.result,status:i.status,isSuccess:!0,displayMessage:null!=(r=i.data.displayMessage)?r:"",errorMessages:null!=(t=i.data.errorMessages)?t:[]}}catch(e){if(console.error("Get historialComparador error:",e),p.A.isAxiosError(e))return{result:[],status:null!=(i=null==(s=e.response)?void 0:s.status)?i:500,isSuccess:!1,displayMessage:null!=(d=null==(l=e.response)||null==(a=l.data)?void 0:a.displayMessage)?d:"Unknown error",errorMessages:null!=(c=null==(o=e.response)||null==(n=o.data)?void 0:n.errorMessages)?c:[e.message]};return{result:[],status:500,isSuccess:!1,displayMessage:"Unknown error",errorMessages:[String(e)]}}},x=e=>{let{filters:r}=e,[t,l]=(0,a.useState)([]),{setLoading:n}=(0,u.r)(),{data:o}=(0,d.wV)();(0,a.useEffect)(()=>{(async()=>{n(!0);try{if(!(null==o?void 0:o.user.token))return;let e=await m(o.user.token,r);200===e.status?l(e.result):console.error("Error cargando usuarios:",e.result)}finally{n(!1)}})()},[null==o?void 0:o.user.token,r]);let i=[{key:"usuario",label:"Usuario",align:"center",render:e=>{var r;return(0,s.jsx)("div",{children:null==(r=e.user)?void 0:r.nombreCompleto})}},{key:"Correo",label:"Correo",align:"center",render:e=>{var r;return(0,s.jsx)("div",{children:null==(r=e.user)?void 0:r.email})}},{key:"cups",label:"CUPS",align:"center"},{key:"consumoAnual",label:"Consumo Anual",render:e=>{var r;return null!=(r=e.consumoAnual)?r:0},align:"center"},{key:"fecha",label:"Fecha",align:"center",render:e=>new Date(e.fecha).toLocaleString()}];return(0,s.jsx)(c.b,{data:t,columns:i,rowKey:"id"})},g=()=>{let[e,r]=(0,a.useState)({});return(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsx)(i,{filters:e,setFilters:r,onSearch:()=>{r({...e,page:1})}}),(0,s.jsx)(x,{filters:e})]})}},9946:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var s=t(2115);let a=e=>{let r=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,t)=>t?t.toUpperCase():r.toLowerCase());return r.charAt(0).toUpperCase()+r.slice(1)},l=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,s.forwardRef)((e,r)=>{let{color:t="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:d="",children:c,iconNode:u,...p}=e;return(0,s.createElement)("svg",{ref:r,...n,width:a,height:a,stroke:t,strokeWidth:i?24*Number(o)/Number(a):o,className:l("lucide",d),...!c&&!(e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0})(p)&&{"aria-hidden":"true"},...p},[...u.map(e=>{let[r,t]=e;return(0,s.createElement)(r,t)}),...Array.isArray(c)?c:[c]])}),i=(e,r)=>{let t=(0,s.forwardRef)((t,n)=>{let{className:i,...d}=t;return(0,s.createElement)(o,{ref:n,iconNode:r,className:l("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...d})});return t.displayName=a(e),t}}},e=>{e.O(0,[281,641,464,441,964,358],()=>e(e.s=2028)),_N_E=e.O()}]);