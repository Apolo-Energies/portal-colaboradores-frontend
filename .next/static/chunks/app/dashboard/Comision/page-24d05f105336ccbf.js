(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[175],{430:(e,r,s)=>{"use strict";s.d(r,{l:()=>n});var t=s(5155),a=s(4416);let n=e=>{let{open:r,onClose:s,children:n,className:o}=e;return r?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-4",children:(0,t.jsxs)("div",{className:"relative w-full max-w-lg rounded-xl p-6 shadow-xl bg-card text-card-foreground ".concat(o),children:[(0,t.jsxs)("button",{onClick:s,className:"absolute cursor-pointer top-4 right-4 text-muted-foreground hover:text-foreground",children:[(0,t.jsx)(a.A,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"sr-only",children:"Cerrar"})]}),n]})}):null}},1216:(e,r,s)=>{"use strict";s.d(r,{k:()=>a});var t=s(5155);s(2115);let a=e=>{let{value:r,className:s=""}=e;return(0,t.jsx)("div",{className:"relative w-full h-2 rounded-full bg-secondary overflow-hidden ".concat(s),role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,children:(0,t.jsx)("div",{className:"h-full bg-primary transition-all duration-300 ease-in-out",style:{width:"".concat(r,"%")}})})}},1932:(e,r,s)=>{"use strict";s.d(r,{cn:()=>n});var t=s(2596),a=s(9688);function n(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];return(0,a.QP)((0,t.$)(r))}},2039:(e,r,s)=>{"use strict";s.d(r,{b:()=>a});var t=s(5155);function a(e){let{data:r,columns:s,rowKey:a}=e;return(0,t.jsx)("div",{className:"bg-card rounded-xl shadow-sm border border-border overflow-hidden",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full table-auto",children:[(0,t.jsx)("thead",{className:"bg-card border-b border-border",children:(0,t.jsx)("tr",{children:null==s?void 0:s.map(e=>(0,t.jsx)("th",{className:"px-6 py-4 text-xs font-medium text-muted-foreground uppercase tracking-wider text-".concat(e.align||"left"),children:e.label},e.key))})}),(0,t.jsx)("tbody",{className:"bg-body divide-y divide-gray-200",children:null==r?void 0:r.map(e=>(0,t.jsx)("tr",{className:"hover:bg-body transition-colors",children:null==s?void 0:s.map(r=>{var s;return(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-".concat(r.align||"left"),children:(null==r?void 0:r.render)?r.render(e):String(null!=(s=e[r.key])?s:"")},r.key)})},String(e[a])))})]})})})}s(2115)},3281:(e,r,s)=>{"use strict";s.d(r,{a:()=>a});var t=s(3464);s(9509).env.NODE_TLS_REJECT_UNAUTHORIZED="0";let a=t.A.create({baseURL:"https://api.apoloenergies.es/api/apolo/v1",responseType:"json",withCredentials:!0})},4616:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(9946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},5626:(e,r,s)=>{Promise.resolve().then(s.bind(s,8002))},5726:(e,r,s)=>{"use strict";s.d(r,{p:()=>a});var t=s(5155);s(2115);let a=e=>{let{label:r,name:s,type:a="text",placeholder:n,register:o,required:l=!1,errors:i,defaultValue:d}=e;return(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("label",{htmlFor:s,className:"block text-sm font-semibold text-foreground",children:[r," ",l&&(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{id:s,type:a,placeholder:n,...o(s,{required:l}),className:"w-full placeholder:text-gray-400 bg-input text-sm rounded border px-3 py-1.5 focus:outline-none focus:ring ".concat(i&&i[s]?"border-red-500 ring-red-500":"border-border ring-blue-500"),defaultValue:d}),i&&i[s]&&(0,t.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"Este campo es obligatorio"})]})}},6378:(e,r,s)=>{"use strict";s.d(r,{$:()=>d});var t=s(5155),a=s(2115),n=s(4624),o=s(2085),l=s(1932);let i=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground cursor-pointer rounded-xl hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground cursor-pointer rounded-xl hover:bg-destructive/90",outline:"border border-popover-foreground rounded-xl bg-background cursor-pointer hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground cursor-pointer rounded-xl hover:bg-secondary/80",ghost:"hover:bg-accent rounded-xl cursor-pointer hover:text-accent-foreground",link:"text-primary underline-offset-4 rounded-xl cursor-pointer hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,r)=>{let{className:s,variant:a,size:o,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,t.jsx)(u,{className:(0,l.cn)(i({variant:a,size:o,className:s})),ref:r,...c})});d.displayName="Button"},6615:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(5453).v)(e=>({reloadFlag:!1,triggerReload:()=>e(e=>({reloadFlag:!e.reloadFlag}))}))},7925:(e,r,s)=>{"use strict";s.d(r,{r:()=>t});let t=(0,s(5453).v)(e=>({loading:!1,setLoading:r=>e({loading:r})}))},8002:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>N});var t=s(5155),a=s(2115),n=s(5493),o=s(7925),l=s(9075),i=s(2039),d=s(6615),c=s(2177),u=s(8519),g=s(430),p=s(1216),x=s(5726);let m=e=>{let{register:r,errors:s,defaultValues:a}=e;return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-xs mx-0 mb-2",children:"Complete los datos b\xe1sicos del usuario"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,t.jsx)(x.p,{label:"Nombre Comisi\xf3n",name:"name",placeholder:"Oro",register:r,required:!0,errors:s,defaultValue:null==a?void 0:a.name}),(0,t.jsx)(x.p,{type:"number",label:"Porcentaje",name:"percentage",placeholder:"30",register:r,required:!0,errors:s,defaultValue:null==a?void 0:a.percentage})]})]})};var h=s(6378);let v=e=>{let{commission:r,onClose:s,open:a}=e,{register:i,handleSubmit:x,formState:{errors:v,isValid:b},reset:y,watch:f}=(0,c.mN)(),{data:j}=(0,n.wV)(),{showAlert:w}=(0,u.B)(),{setLoading:N}=(0,o.r)(),{triggerReload:k}=(0,d.A)(),C=f(),M=()=>{let e=Object.values(C).filter(e=>"string"==typeof e&&""!==e.trim()),r=Object.keys(C).length;return Math.round(e.length/r*100)},A=async e=>{let t={...e,id:r.id};try{N(!0);let e=null==j?void 0:j.user.token;if(!e)throw Error("No se encontr\xf3 el token de autenticaci\xf3n.");let r=await (0,l.LZ)(e,t);200===r.status||201===r.status?(w("Comisi\xf3n agregada correctamente: ","success"),y(),s(),k()):w("Error al agregar Comisi\xf3n: ","error")}catch(e){w("Error al agregar Comisi\xf3n: ","error"),console.error("Error inesperado al agregar Comisi\xf3n:",e)}finally{N(!1)}};return(0,t.jsxs)(g.l,{open:a,onClose:s,children:[(0,t.jsxs)("div",{className:"space-y-2 px-4 pt-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Progreso"}),(0,t.jsxs)("span",{children:[M(),"%"]})]}),(0,t.jsx)(p.k,{value:M()})]}),(0,t.jsx)("form",{onSubmit:x(A),className:"space-y-4 max-h-96 overflow-y-auto px-4 py-4",children:(0,t.jsx)(m,{defaultValues:r,register:i,errors:v})}),(0,t.jsx)("div",{className:"sticky bottom-0 px-4 ",children:(0,t.jsxs)("div",{className:"border-t border-border py-3 flex items-center justify-between",children:[(0,t.jsx)(h.$,{variant:"outline",onClick:()=>{y(),s()},children:"Cancelar"}),(0,t.jsx)(h.$,{onClick:x(A),disabled:!b,children:"Guardar"})]})})]})},b=()=>{let[e,r]=(0,a.useState)([]),[s,c]=(0,a.useState)(),[u,g]=(0,a.useState)(!1),{data:p,status:x}=(0,n.wV)(),{setLoading:m}=(0,o.r)(),{reloadFlag:h}=(0,d.A)();(0,a.useEffect)(()=>{let e=async()=>{if(null==p?void 0:p.user.token){m(!0);try{let e=await (0,l.Z9)(p.user.token);200===e.status?r(e.result):console.error("Error cargando comisiones:",e.result)}finally{m(!1)}}};"authenticated"===x&&e()},[null==p?void 0:p.user.token,h]);let b=[{key:"name",label:"Nombre Comisi\xf3n",render:e=>(0,t.jsx)("span",{className:"text-sm text-accent-foreground",children:e.name})},{key:"percentage",label:"Porcentaje",align:"center",render:e=>(0,t.jsxs)("span",{className:"text-sm font-medium",children:[e.percentage,"%"]})},{key:"acciones",label:"Acciones",align:"center",render:e=>(0,t.jsx)("button",{onClick:()=>{c(e),g(!0)},className:"text-indigo-600 hover:text-indigo-900 transition-colors cursor-pointer",children:"Editar"})}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.b,{data:e,columns:b,rowKey:"id"}),s&&(0,t.jsx)(v,{open:u,commission:s,onClose:()=>g(!1)})]})},y=e=>{let{onClose:r,open:s}=e,{register:a,handleSubmit:o,formState:{errors:i,isValid:x},reset:v,watch:b}=(0,c.mN)({}),{data:y}=(0,n.wV)(),{showAlert:f}=(0,u.B)(),{triggerReload:j}=(0,d.A)(),w=b(),N=()=>{let e=Object.values(w).filter(e=>"string"==typeof e&&""!==e.trim()),r=Object.keys(w).length;return Math.round(e.length/r*100)},k=async e=>{try{let s=null==y?void 0:y.user.token;if(!s)throw Error("No se encontr\xf3 el token de autenticaci\xf3n.");let t=await (0,l.LL)(s,e);200===t.status||201===t.status?(f("Comisi\xf3n agregada correctamente: ","success"),v(),r(),j()):f("Error al agregar Comisi\xf3n: ","error")}catch(e){f("Error inesperado agregar Comisi\xf3n: ","error"),console.error("Error inesperado al agregar Comisi\xf3n:",e)}};return(0,t.jsxs)(g.l,{open:s,onClose:r,children:[(0,t.jsxs)("div",{className:"space-y-2 px-4 pt-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Progreso"}),(0,t.jsxs)("span",{children:[N(),"%"]})]}),(0,t.jsx)(p.k,{value:N()})]}),(0,t.jsx)("form",{onSubmit:o(k),className:"space-y-4 max-h-96 overflow-y-auto px-4 py-4",children:(0,t.jsx)(m,{register:a,errors:i})}),(0,t.jsx)("div",{className:"sticky bottom-0 px-4 ",children:(0,t.jsxs)("div",{className:"border-t border-border py-3 flex items-center justify-between",children:[(0,t.jsx)(h.$,{variant:"outline",onClick:()=>{v(),r()},children:"Cancelar"}),(0,t.jsx)(h.$,{onClick:o(k),disabled:!x,children:"Crear Comisi\xf3n"})]})})]})};var f=s(4616);let j=()=>{let[e,r]=(0,a.useState)(!1);return(0,t.jsxs)("div",{className:"bg-card rounded-xl shadow-sm border border-border p-6 mb-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-foreground",children:"Gesti\xf3n de Usuarios"}),(0,t.jsxs)("button",{onClick:()=>void r(!0),className:"flex items-center gap-2 cursor-pointer bg-blue-600 text-foreground px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[(0,t.jsx)(f.A,{size:20}),"Agregar Comisi\xf3n"]})]}),(0,t.jsx)(y,{open:e,onClose:()=>r(!1)})]})},w=()=>(0,t.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,t.jsx)(j,{}),(0,t.jsx)(b,{})]});function N(){return(0,t.jsx)(w,{})}},8519:(e,r,s)=>{"use strict";s.d(r,{B:()=>t});let t=(0,s(5453).v)(e=>({alert:{message:"",type:"info",visible:!1},showAlert:(r,s)=>e({alert:{message:r,type:s,visible:!0}}),hideAlert:()=>e({alert:{message:"",type:"info",visible:!1}})}))},9075:(e,r,s)=>{"use strict";s.d(r,{LL:()=>o,LZ:()=>i,RU:()=>l,Z9:()=>n});var t=s(3464),a=s(3281);let n=async e=>{var r,s,n,o,l,i;try{let s=await a.a.get("/commission",{headers:{Authorization:"Bearer ".concat(e)},withCredentials:!1});return{result:s.data.result,status:s.status,isSuccess:!0,displayMessage:null!=(r=s.data.displayMessage)?r:"",errorMessages:[]}}catch(e){if(console.error("Get users error:",e),t.A.isAxiosError(e))return{result:[],status:null!=(l=null==(s=e.response)?void 0:s.status)?l:500,isSuccess:!1,displayMessage:null!=(i=null==(o=e.response)||null==(n=o.data)?void 0:n.displayMessage)?i:"Unknown error",errorMessages:[e.message]};return{result:[],status:500,isSuccess:!1,displayMessage:"Unknown error",errorMessages:["An unexpected error occurred"]}}},o=async(e,r)=>{var s,n,o,l,i,d;try{let t=await a.a.post("/commission/create",r,{headers:{Authorization:"Bearer ".concat(e)},withCredentials:!1});return{result:t.data.result,status:t.status,isSuccess:!0,displayMessage:null!=(s=t.data.displayMessage)?s:"",errorMessages:[]}}catch(e){if(console.error("Register user error:",e),t.A.isAxiosError(e))return{result:{},status:null!=(i=null==(n=e.response)?void 0:n.status)?i:500,isSuccess:!1,displayMessage:null!=(d=null==(l=e.response)||null==(o=l.data)?void 0:o.displayMessage)?d:"Unknown error",errorMessages:[e.message]};return{result:{},status:500,isSuccess:!1,displayMessage:"Unknown error",errorMessages:["An unexpected error occurred"]}}},l=async(e,r)=>{var s,n,o,l,i,d;try{let t=await a.a.post("/usercommission/assign",r,{headers:{Authorization:"Bearer ".concat(e)},withCredentials:!1});return{result:t.data.result,status:t.status,isSuccess:!0,displayMessage:null!=(s=t.data.displayMessage)?s:"",errorMessages:[]}}catch(e){if(console.error("Assign commission error:",e),t.A.isAxiosError(e))return{result:{},status:null!=(i=null==(n=e.response)?void 0:n.status)?i:500,isSuccess:!1,displayMessage:null!=(d=null==(l=e.response)||null==(o=l.data)?void 0:o.displayMessage)?d:"Unknown error",errorMessages:[e.message]};return{result:{},status:500,isSuccess:!1,displayMessage:"Unknown error",errorMessages:["An unexpected error occurred"]}}},i=async(e,r)=>{var s,n,o,l,i,d;try{let t=await a.a.put("/commission/update/".concat(r.id),r,{headers:{Authorization:"Bearer ".concat(e)},withCredentials:!1});return{result:t.data.result,status:t.status,isSuccess:!0,displayMessage:null!=(s=t.data.displayMessage)?s:"",errorMessages:[]}}catch(e){if(console.error("Register user error:",e),t.A.isAxiosError(e))return{result:{},status:null!=(i=null==(n=e.response)?void 0:n.status)?i:500,isSuccess:!1,displayMessage:null!=(d=null==(l=e.response)||null==(o=l.data)?void 0:o.displayMessage)?d:"Unknown error",errorMessages:[e.message]};return{result:{},status:500,isSuccess:!1,displayMessage:"Unknown error",errorMessages:["An unexpected error occurred"]}}}}},e=>{e.O(0,[497,281,641,464,488,441,964,358],()=>e(e.s=5626)),_N_E=e.O()}]);